#!/bin/bash

clear
figlet "GTX IP-TRACER" | lolcat

echo ""
echo -e "\033[33m---------------------------------------------\033[0m"
echo -e "               \033[93mKULLANIM KILAVUZU\033[0m"
echo -e "\033[33m---------------------------------------------\033[0m"
echo -e "\033[38;5;214mGTX-MN\033[0m yazarsanÄ±z tekrar kullanÄ±m kÄ±lavuzuna ulaÅŸÄ±rsÄ±nÄ±z."
echo -e "\033[92mGTX-M\033[0m yazarsanÄ±z kendi IP adresinize bakarsÄ±nÄ±z."
echo -e "LÃ¼tfen \033[96m78.225.178.98\033[0m veya \033[96m4.6.2.6\033[0m gibi IP'ler girin."
echo -e ""
echo -e "Bu araÃ§ \033[35mGtxAnqel\033[0m tarafÄ±ndan TÃ¼rkÃ§e ve yerli yapÄ±lmÄ±ÅŸtÄ±r."
echo -e "Herkese saygÄ±larÄ±mla."
echo ""

function bilgi_goster {
    ip="$1"
    echo -e "\033[93m[!] Bilgiler alÄ±nÄ±yor... LÃ¼tfen bekleyin.\033[0m"

    data=$(curl -s "http://ip-api.com/json/$ip?fields=status,country,regionName,city,district,zip,lat,lon,message")

    status=$(echo "$data" | grep -oP '(?<="status":")[^"]+')

    if [[ "$status" != "success" ]]; then
        message=$(echo "$data" | grep -oP '(?<="message":")[^"]+')
        echo -e "\033[31m[!] Hata: $message\033[0m"
        return
    fi

    country=$(echo "$data" | grep -oP '(?<="country":")[^"]+')
    region=$(echo "$data" | grep -oP '(?<="regionName":")[^"]+')
    city=$(echo "$data" | grep -oP '(?<="city":")[^"]+')
    district=$(echo "$data" | grep -oP '(?<="district":")[^"]+')
    zip=$(echo "$data" | grep -oP '(?<="zip":")[^"]+')
    lat=$(echo "$data" | grep -oP '(?<="lat":)[^,]+')
    lon=$(echo "$data" | grep -oP '(?<="lon":")[^,}]+')

    [[ -z "$district" ]] && district="Bilinmiyor"
    [[ -z "$zip" ]] && zip="Bilinmiyor"

    echo -e "\033[92mIP BÄ°LGÄ°SÄ°:"
    echo -e "\033[0m  IP        : $ip"
    echo -e "  Ãœlke      : $country"
    echo -e "  BÃ¶lge     : $region"
    echo -e "  Åehir     : $city"
    echo -e "  Ä°lÃ§e      : $district"
    echo -e "  Posta Kodu: $zip"
    echo -e "  Koordinat : $lat, $lon"
    echo -e "  Harita    : https://maps.google.com/?q=$lat,$lon"
    echo ""
}

read -p $'\033[33mğŸ” IP adresi ya da komut (GTX-M / GTX-MN): \033[0m' girdi

if [[ "$girdi" == "GTX-M" ]]; then
    ip=$(curl -s ifconfig.me)
    bilgi_goster "$ip"
elif [[ "$girdi" == "GTX-MN" ]]; then
    exec "$0"
elif [[ "$girdi" =~ ^[0-9]+\.[0-9]+\.[0-9]+\.[0-9]+$ ]]; then
    bilgi_goster "$girdi"
else
    echo -e "\033[31m[!] GeÃ§ersiz giriÅŸ. LÃ¼tfen geÃ§erli bir IP ya da komut girin.\033[0m"
fi